<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ìŠµë“ë¬¼ ìƒì„¸ë³´ê¸°</title>
  <link rel="stylesheet" href="../static/css/Notice_LostFound.css">
</head>
<body>
  <div class="container">

<!-- ì´ë¯¸ì§€ í™•ëŒ€ ëª¨ë‹¬ -->
<div id="imgModal" class="img-modal">
  <span class="img-modal-close">&times;</span>
  <img class="img-modal-content" id="modalImg">
</div>

    <h1 id="title"></h1>
    <div class="meta" id="meta"></div>

    <h1 id="title"></h1>
    <div class="meta">ì‘ì„±ì: <span id="author">-</span></div>

    <!-- í´ë¦­ í™•ëŒ€ ê¸°ëŠ¥ì´ ì ìš©ë  ì‚¬ì§„ ì˜ì—­ -->
    <div class="photo" id="photo">ì‚¬ì§„ ì—†ìŒ</div>

      <div class="notice_wrapper">

  <!-- ì™¼ìª½ ì˜ì—­ -->
  <div class="left_box">
    <div class="info-box">
      <div class="info-title">ë¬¼í’ˆëª…</div>
      <div class="info-text" id="item">-</div>
    </div>

    <div class="info-box">
      <div class="info-title">ë‚ ì§œ/ì‹œê°„</div>
      <div class="info-text" id="date">-</div>
    </div>

    <div class="info-box">
      <div class="info-title">ìŠµë“ ì¥ì†Œ</div>
      <div class="info-text" id="place">-</div>
    </div>
  </div>

  <!-- ì˜¤ë¥¸ìª½ ì˜ì—­ -->
  <div class="right_box">
    <div class="info-box">
      <div class="info-title">ì „í™”ë²ˆí˜¸</div>
      <div class="info-text" id="phone">-</div>
    </div>

    <div class="info-box">
      <div class="info-title">ì„¸ë¶€ ì‚¬í•­</div>
      <div class="info-text" id="content">-</div>
    </div>

  </div>

</div>

    <a href="./index.html" class="back">â† ëª©ë¡ìœ¼ë¡œ ëŒì•„ê°€ê¸°</a>
  </div>

<script>
    async function loadDetail() {
    const params = new URLSearchParams(window.location.search);
    const id = params.get('id');

    if (id === null) {
        alert("ì˜ëª»ëœ ì ‘ê·¼ì…ë‹ˆë‹¤.");
        window.location.href = './index.html';
        return;
    }

    try {
        const res = await fetch(`http://127.0.0.1:5000/api/found/${id}`);

        if (res.ok) {
            const data = await res.json();

            // ê¸°ë³¸ ì •ë³´ ì±„ìš°ê¸°
            document.getElementById('title').innerText = data.title;
            document.getElementById('author').innerText = data.author || 'ìµëª…';
            document.getElementById('item').innerText = data.item_name;
            document.getElementById('date').innerText = data.date || '-';
            document.getElementById('place').innerText = data.place;
            document.getElementById('phone').innerText = data.phone || 'ë¹„ê³µê°œ';
            document.getElementById('content').innerText = data.content;

            // â¬‡ï¸ ì‚¬ì§„ í‘œì‹œ + í´ë¦­ í™•ëŒ€ ê¸°ëŠ¥
            if (data.image) {
                document.getElementById('photo').innerHTML = 
                    `<img id="detailImg" src="../static/uploads/${data.image}" 
                          style="max-width:100%; border-radius:8px; cursor:pointer;">`;

                setupImageModal();
            }
        } else {
            alert("ì‚­ì œë˜ì—ˆê±°ë‚˜ ì—†ëŠ” ê²Œì‹œê¸€ì…ë‹ˆë‹¤.");
            window.location.href = './index.html';
        }
    } catch (e) {
        console.error(e);
        alert("ì„œë²„ ì—°ê²° ì‹¤íŒ¨");
    }
}


// ğŸ“Œ ì´ë¯¸ì§€ í´ë¦­ ì‹œ ëª¨ë‹¬(ì „ì²´ í™”ë©´ í™•ëŒ€) ê¸°ëŠ¥
function setupImageModal() {
    const modal = document.getElementById("imgModal");
    const modalImg = document.getElementById("modalImg");
    const closeBtn = document.querySelector(".img-modal-close");
    const detailImg = document.getElementById("detailImg");

    if (!detailImg) return;

    // ì´ë¯¸ì§€ í´ë¦­ â†’ ëª¨ë‹¬ ì—´ë¦¼
    detailImg.onclick = () => {
        modal.style.display = "block";
        modalImg.src = detailImg.src;
    };

    // ë‹«ê¸° ë²„íŠ¼(X)
    closeBtn.onclick = () => {
        modal.style.display = "none";
    };

    // ëª¨ë‹¬ ë°°ê²½ í´ë¦­ â†’ ë‹«ê¸°
    modal.onclick = (e) => {
        if (e.target === modal) {
            modal.style.display = "none";
        }
    };
}


window.onload = loadDetail;

</script>

</body>
</html>
