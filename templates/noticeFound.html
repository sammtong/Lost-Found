<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>습득물 상세보기</title>
  <link rel="stylesheet" href="../static/css/Notice_LostFound.css">
</head>
<body>
  <div class="container">
    <h1 id="title">물품명 불러오는 중...</h1>
    <div class="meta">작성자: <span id="author">-</span></div>

    <div class="photo" id="photo">사진 없음</div>

    <div class="notice_wrapper">
      <div class="left_box">
        <div class="info-box">
          <div class="info-title">물품명</div>
          <div class="info-text" id="item">-</div>
        </div>
        <div class="info-box">
          <div class="info-title">날짜/시간</div>
          <div class="info-text" id="date">-</div>
        </div>
        <div class="info-box">
          <div class="info-title">습득 장소</div>
          <div class="info-text" id="place">-</div>
        </div>
      </div>

      <div class="right_box">
        <div class="info-box">
          <div class="info-title">전화번호</div>
          <div class="info-text" id="phone">-</div>
        </div>
        <div class="info-box">
          <div class="info-title">세부 사항</div>
          <div class="info-text" id="content">-</div>
        </div>
      </div>
    </div>

    <a href="./index.html" class="back">← 목록으로 돌아가기</a>
  </div>

  <script>
      async function loadDetail() {
          const params = new URLSearchParams(window.location.search);
          const id = params.get('id');

          if (id === null) {
              alert("잘못된 접근입니다.");
              window.location.href = './index.html';
              return;
          }

          try {
              const res = await fetch(`http://127.0.0.1:5000/api/found/${id}`);
              
              if (res.ok) {
                  const data = await res.json();
                  
                  // 데이터 채우기
                  document.getElementById('title').innerText = data.title;
                  document.getElementById('author').innerText = data.author || '익명';
                  document.getElementById('item').innerText = data.item_name;
                  document.getElementById('date').innerText = data.date || '-';
                  document.getElementById('place').innerText = data.place;
                  document.getElementById('phone').innerText = data.phone || '비공개';
                  document.getElementById('content').innerText = data.content;

                  // 사진 표시
                  if (data.image) {
                      document.getElementById('photo').innerHTML = `<img src="../static/uploads/${data.image}" style="max-width:100%; border-radius:8px;">`;
                  }
              } else {
                  alert("삭제되었거나 없는 게시글입니다.");
                  window.location.href = './index.html';
              }
          } catch (e) {
              console.error(e);
              alert("서버 연결 실패");
          }
      }

      window.onload = loadDetail;
  </script>
</body>
</html>