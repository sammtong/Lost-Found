<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>습득물 상세보기</title>
  <link rel="stylesheet" href="../static/css/Notice_LostFound.css">
</head>
<body>
  <div class="container">
    <!-- 이미지 확대 모달 -->
<div id="imgModal" class="img-modal">
  <span class="img-modal-close">&times;</span>
  <img class="img-modal-content" id="modalImg">
</div>

    <h1 id="title">제목 불러오는 중...</h1>
    <div class="meta" id="meta"></div>

    <div class="photo" id="photo">사진 불러오는 중...</div>

      <div class="notice_wrapper">

  <!-- 왼쪽 영역 -->
  <div class="left_box">
    <div class="info-box">
      <div class="info-title">물품명</div>
      <div class="info-text" id="item">-</div>
    </div>

    <div class="info-box">
      <div class="info-title">날짜/시간</div>
      <div class="info-text" id="date">-</div>
    </div>

    <div class="info-box">
      <div class="info-title">습득 장소</div>
      <div class="info-text" id="place">-</div>
    </div>
  </div>

  <!-- 오른쪽 영역 -->
  <div class="right_box">
    <div class="info-box">
      <div class="info-title">전화번호</div>
      <div class="info-text" id="phone">-</div>
    </div>

    <div class="info-box">
      <div class="info-title">세부 사항</div>
      <div class="info-text" id="content">-</div>
    </div>
  </div>

</div>

    

    <a href="./index.html" class="back">← 목록으로 돌아가기</a>
  </div>

<script>
    async function loadDetail() {
        const params = new URLSearchParams(window.location.search);
        const id = params.get('id');

        if (id === null) {
            alert("잘못된 접근입니다.");
            window.location.href = './index.html';
            return;
        }

        try {
            const res = await fetch(`http://127.0.0.1:5000/api/found/${id}`);
            
            if (res.ok) {
                const data = await res.json();
                document.getElementById('title').innerText = data.title;
                document.getElementById('item').innerText = data.item_name;
                document.getElementById('place').innerText = data.place;
                document.getElementById('content').innerText = data.content;

                const photoDiv = document.getElementById('photo');

                if (data.photo_url) {
                    photoDiv.innerHTML = `<img src="${data.photo_url}" id="detailImg" style="width:200px;cursor:pointer;border-radius:10px;">`;

                    // 사진 클릭 이벤트 (모달 열기)
                    const modal = document.getElementById("imgModal");
                    const modalImg = document.getElementById("modalImg");
                    const detailImg = document.getElementById("detailImg");
                    const closeBtn = document.querySelector(".img-modal-close");

                    detailImg.onclick = () => {
                        modal.style.display = "block";
                        modalImg.src = detailImg.src;
                    };

                    closeBtn.onclick = () => {
                        modal.style.display = "none";
                    };

                    // 모달 배경 클릭 시 닫기
                    modal.onclick = (e) => {
                        if (e.target === modal) modal.style.display = "none";
                    };

                } else {
                    photoDiv.innerText = "사진 없음";
                }

            } else {
                alert("삭제되었거나 없는 게시글입니다.");
                window.location.href = './index.html';
            }
        } catch (e) {
            console.error(e);
            alert("서버 연결 실패");
        }
    }

    window.onload = loadDetail;
</script>

</body>
</html>